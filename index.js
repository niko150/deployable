!function(){"use strict";var t=function(t,n){for(var e,r=arguments,a=[],o=[],i=arguments.length;i-- >2;)a[a.length]=r[i];for(;a.length;)if(Array.isArray(e=a.pop()))for(var i=e.length;i--;)a[a.length]=e[i];else null!=e&&!0!==e&&!1!==e&&("number"==typeof e&&(e+=""),o[o.length]=e);return"string"==typeof t?{tag:t,data:n||{},children:o}:t(n,o)},n=function(t){function n(n){var e,r={};for(var a in t.view){var o=[];e||"*"===a||n.replace(RegExp("^"+a.replace(/\//g,"\\/").replace(/:([\w]+)/g,function(t,n){return o.push(n),"([-\\w]+)"})+"/?$","g"),function(){for(var t=arguments,n=1;n<arguments.length-2;)r[o.shift()]=t[n++];e=a})}return{match:e||"*",params:r}}return{state:{router:n(location.pathname)},actions:{router:{match:function(t,e,r,a){return{router:a("route",n(r))}},go:function(t,n,e){history.pushState({},"",e),n.router.match(e.split("?")[0])}}},events:{loaded:function(t,n){function e(){n.router.match(location.pathname)}e(),addEventListener("popstate",e)},render:function(t,n,e){return e[t.router.match]}}}};!function(t){function n(t,e,i){Object.keys(e||[]).map(function(u){var c=e[u],f=i?i+"."+u:u;"function"==typeof c?t[u]=function(t){var n=c(h,g,r("action",{name:f,data:t}).data,r);if(null==n||"function"==typeof n.then)return n;a(h=o(h,r("update",n)),p)}:n(t[u]||(t[u]={}),c,f)})}function e(){a(h,p),r("loaded")}function r(t,n){return(m[t]||[]).map(function(t){var e=t(h,g,n,r);null!=e&&(n=e)}),n}function a(n,e){v=d(t.root||(t.root=document.body),v,s,s=r("render",e)(n,g))}function o(t,n){var e={};if("object"!=typeof n||Array.isArray(n))return n;for(var r in t)e[r]=t[r];for(var r in n)e[r]=n[r];return e}function i(t,n){if("string"==typeof t)var e=document.createTextNode(t);else{for(var e=(n=n||"svg"===t.tag)?document.createElementNS("http://www.w3.org/2000/svg",t.tag):document.createElement(t.tag),r=0;r<t.children.length;)e.appendChild(i(t.children[r++],n));for(var r in t.data)"oncreate"===r?t.data[r](e):u(e,r,t.data[r])}return e}function u(t,n,e,r){if("key"===n);else if("style"===n)for(var a in o(r,e=e||{}))t.style[a]=e[a]||"";else{try{t[n]=e}catch(t){}"function"!=typeof e&&(e?t.setAttribute(n,e):t.removeAttribute(n))}}function c(t,n,e){for(var r in o(n,e)){var a=e[r],i="value"===r||"checked"===r?t[r]:n[r];"onupdate"===r&&a?a(t):a!==i&&u(t,r,a,i)}}function f(t){if(t&&(t=t.data))return t.key}function l(t,n,e){function r(){t.removeChild(n)}(e.data&&e.data.onremove||r)(n,r)}function d(t,n,e,r){if(null==e)n=t.insertBefore(i(r),n);else if(r.tag&&r.tag===e.tag){c(n,e.data,r.data);for(var a=r.children.length,o=e.children.length,u={},s=[],v={},h=0;h<o;h++){var p=n.childNodes[h];s[h]=p;var g=e.children[h],m=f(g);null!=m&&(u[m]=[p,g])}for(var h=0,y=0;y<a;){var p=s[h],g=e.children[h],k=r.children[y],m=f(g);if(v[m])h++;else{var w=f(k),b=u[w]||[];null==w?(null==m&&(d(n,p,g,k),y++),h++):(m===w?(d(n,b[0],b[1],k),h++):b[0]?(n.insertBefore(b[0],p),d(n,b[0],b[1],k)):d(n,p,null,k),y++,v[w]=k)}}for(;h<o;){var g=e.children[h],m=f(g);null==m&&l(n,s[h],g),h++}for(var h in u){var b=u[h],A=b[1];v[A.data.key]||l(n,b[0],A)}}else if(r!==e){var h=n;t.replaceChild(n=i(r),h)}return n}for(var s,v,h={},p=t.view,g={},m={},y=-1,k=t.plugins||[];y<k.length;y++){var w=k[y]?k[y](t):t;null!=w.state&&(h=o(h,w.state)),n(g,w.actions),Object.keys(w.events||[]).map(function(t){m[t]=(m[t]||[]).concat(w.events[t])})}"l"!==document.readyState[0]?e():addEventListener("DOMContentLoaded",e)}({state:{count:0},actions:{add:function(t){return{count:t.count+1}}},view:{"/":function(n,e){return t("button",{onclick:e.add},n.count)},"*":function(n,e){return t("h1",{onclick:function(t){return e.router.go("/")}},"Back to ",location.hostname)}},plugins:[n]})}();
